{% extends 'Page/page_base.html' %}
{% load static %}

{% block style %}
<link rel="stylesheet" type="text/css" href="{% static '/css/check_out_before_due.css'%}">
{% endblock %}

{% block script %}
<script type="text/javascript" src="{% static '/js/check_out_before_due.js' %}"></script>
<script>
    let csrf_token = '{{csrf_token}}';
    const checkout_url = "{% url 'kmutnbtrackapp:check_out' last_lab.hash  %}";
function checkout(){
    fetch(checkout_url,{
        method: "POST",
        headers: { "X-CSRFToken": csrf_token },
    })
    .then(response =>{ 
        return response.text()
    })
    .then(html =>{
        document.getElementsByTagName("body")[0].innerHTML = html
    })
}
</script>
{% endblock %}

{% block content %}
<!-- navbar room name -->
<nav class="navbar navbar-dark" style="background-color: #355C7D;">
    <a class="navbar-brand" href="#">
        <img src="{% static 'images/desktop.png' %}" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">
        {{ last_lab.name }}
    </a>
    <a href="{% url 'kmutnbtrackapp:logout' %}?lab={{ last_lab.hash }}">
        <button class="btn btn-danger my-2 my-sm-0">
            ล็อกเอาท์
        </button>
    </a>
</nav>

<!-- check out before due -->
<div class="container">
    <div class="alert alert-warning" role="alert">
        <h4 class="alert-heading">คุณต้องการเช็คเอาท์ {{ lab_hash_check_out.name }} ก่อนเวลาหรือไม่?</h4>
        <p></p>
        <hr>
        <p class="mb-0">เวลาเช็คเอาท์จะถูกเปลี่ยนเป็นเวลา ณ ขณะนี้</p>
    </div>
    <div style="display: flex; justify-content: center; align-items: center;">
            <button type="button" class="btn btn-warning" style="color:#FFFFFF"; onclick="checkout()">
                <img id="checkout_img" src="{% static 'images/logout_2.png' %}" alt="checkout_pic">
                เช็คเอาท์
            </button>
    </div>
</div>
{% endblock %}